<html lang="en">

<head>
    <title>One 1000</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="css/user.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.0/css/mdb.min.css" rel="stylesheet">

</head>

<body>
    <nav class="navbar sticky-top navbar-expand-lg white">
        <!-- Navbar brand -->
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link p-0 brand" href="/home">
                    <img src="images/one1000-primary-logo.png" class="z-depth-0" alt="avatar image" height="90">
                </a>
            </li>
        </ul>
    
        

        <!-- Collapsible content -->
        <div class="collapse navbar-collapse" id="basicExampleNav">
            <!-- Links -->
            <ul class="navbar-nav mr-auto ml-lg-5 pl-lg-5">
                <li class="nav-item">
                    <a class="nav-link active text-dark" href="/userDashboard">Dashboard</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-dark" href="/home">Home
                        <span class="sr-only">(current)</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-dark" href="/webinar">Webinar</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-dark" href="/onlinetraining">Online Training</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-dark" href="/about">About us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-dark" href="/contact">Contact us</a>
                </li>
            </ul>
            <!-- Links -->

            <!-- Collapsible content -->
            
            <!-- <a class="nav-link" href="signin.html">Login</a> -->
            <!-- <a href="signup.html" style="border-radius: 15px; background: #017EBE;" class="btn text-white btn-md ml-3">Get Started</a> -->
        </div>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-list-4" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div>
            <ul class="navbar-nav ml-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link brand" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img src="images/Ellipse-2.png" width="50" height="50" class="rounded-circle">
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item" href="/user_profile">My Profile</a>
                        <a class="dropdown-item text-danger" href="/logout">Log Out</a>
                    </div>
                </li>
            </ul>
        </div>
        <!-- Collapse button -->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
            aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            <i class="fas fa-bars"></i>
        </button>
    </nav>

    <!-- home page -->

    <!-- header -->

    <div class="container-fluid px-5 header-webinar">
        <div class="row mb-3">
            <i class="fa-solid fa-angle-left fa-lg text-muted px-3"></i>
            <h5 class="font-weight-bold small">Course Exam</h5>
            </div>
        <div class="row align-items-center">
            <div class="col-lg-8 col-12">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="d-flex justify-content-between align-items-center" style="background-color: #017EBE; color:#fff">
                            <h5 class="card-header" id="question"><%= quiz.question[0] %></h5>
                            <h6 class="mr-3" id="length">1/<%= quiz.question.length %></h6>
                        </div>
                        
                        <div class="card-body mt-5">
                            <div class="ml-md-3 ml-sm-3 pt-sm-0 pt-5" id="options">
                                <label for="correct" class="options">
                                    <span id="correctLabel"><%= quiz.correct[0] %></span>
                                    <input  type="radio" id="correct" name="quiz" value="<%= quiz.correct[0] %>">
                                    <span class="checkmark"></span>
                                </label>
                                <label for="wrongOne" class="options">
                                    <span id="wrongLabelOne"><%= quiz.wrong[0][0] %></span>
                                    <input  type="radio" id="wrongOne" name="quiz" value="<%= quiz.wrong[0][0] %>">
                                    <span class="checkmark"></span>
                                </label>
                                <label for="wrongTwo" class="options">
                                    <span id="wrongLabelTwo"><%= quiz.wrong[0][1] %></span>
                                    <input  type="radio" id="wrongTwo" name="quiz" value="<%= quiz.wrong[0][1] %>">
                                    <span class="checkmark"></span>
                                </label>
                                <label for="wrongThree" class="options">
                                    <span id="wrongLabelThree"><%= quiz.wrong[0][2] %></span>
                                    <input  type="radio" id="wrongThree" name="quiz" value="<%= quiz.wrong[0][2] %>">
                                    <span class="checkmark"></span>
                                </label>
                            </div>
                            <div class="row mt-5 pt-5">
                                <div class="col-lg-4">
                                    <input type="hidden" value="<%= courseID %>" id="courseID" />
                                    <div class="text-center">
                                        <button id="submitQuiz" class="btn text-center" style="color: white; border-radius: 15px; background: #3CB179;" name="signin">Submit</button>
                                        <!-- <a href="/exam" class="btn text-center" style="color: white; border-radius: 15px; background: #3CB179;" name="signin">Submit</a> -->
                                        <a href="/exam" class="text-center ml-4" style="color:#017EBE;" name="signup">Skip</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Modal -->
                    <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                        <div class="modal-content text-center p-3">
                            <div class="text-center d-flex flex-row">
                                <img src="images/trophy-1.png" class="z-depth-0 mt-n5 mb-5 img-fluid mx-auto" style="height:50%!important; width:50%!important;" alt="avatar image">
                            </div>
                            <div class="modal-body d-flex flex-column mb-4">
                                <span class="font-weight-bold" id="result">12 / 15,  Passed</span>
                                <span class="font-weight-bold">Congratulation, You have passed the exams</span>
                                <span class="text-muted small">You can now view your certificate from below link</span>
                            </div>
                            <div class="col-lg-12 d-flex justify-content-center">
                                <button data-toggle="modal" data-target="#exampleModal" type="button" class="btn btn-block w-50" style="border-radius: 15px; color:white; background: #017EBE;">View Certificate</button>
                            </div>
                        </div>
                        </div>
                    </div>
                    
                    <!-- Certificate Modal -->
                    <!-- Modal -->
                    <div class="modal custom-modal fade py-3" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content custom-modal">
                                <div class="modal-header custom-modal">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span class="fa-stack">
                                            <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                                            <i class="fa fa-xmark fa-stack-1x"></i>
                                        </span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <img class="img-fluid" src="images/Certificate-employee-1.png">
                                </div>
                                <div class="modal-footer custom-modal d-flex justify-content-around">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                                        <i class="fa fa-download fa-stack-1x"></i>
                                    </span>
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                                        <i class="fa fa-print fa-stack-1x"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- <div class="col-lg-3">
                        <a href="checkout.html" class="btn my-5 btn-block"
                            style="background-color:#017EBE; color: white; border-radius: 15px;">Confirm</a>
                    </div> -->
                </div>

            </div>
            <div class="col-lg-4 col-12 mt-5 pt-5">
                <div class="col-lg-6 col-12 mx-auto d-block exam-img-div">
                    <img class="img-fluid exam-img-1" src="images/Rectangle-6.png" alt="login-image" />
                    <img class="img-fluid exam-img-2" src="images/pngwing-1.png" alt="login-image" />
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer id="footer" class="font-small text-white pt-4">

         <!-- Footer Elements -->
         <div class="container">
            <div class="row">
                <div class="col-lg-4">
                    <a class="nav-link p-0" href="/home">
                        <img src="images/one1000-primary-logo.png" class="z-depth-0" alt="avatar image" height="140">
                    </a>
                </div>
                <div class="col-lg-4">
                    <h5 class="text-white mb-3">Quick links</h5>
                    <ul class="list-unstyled text-muted">
                        <li><a class="text-white-50 small" href="/home">Home</a></li>
                        <li><a class="text-white-50 small" href="/about">About</a></li>
                        <li><a class="text-white-50 small" href="/signup">Get started</a></li>
                    </ul>
                </div>
                <div class="col-lg-4">
                    <h5 class="text-white mb-3">Join me on social media</h5>
                    <ul class="list-unstyled text-muted">
                        <li><a class="text-white-50 small" target="_blank" href="https://www.facebook.com/WESTrainingandConsulting"><i class="fa-brands fa-facebook-f mr-2"></i>WESTrainingandConsulting</a></li>
                        <li><a class="text-white-50 small" target="_blank" href="https://www.instagram.com/WEStc/"><i class="fa-brands fa-instagram mr-2"></i>WEStc</a></li>
                        <li><a class="text-white-50 small" target="_blank" href="https://www.linkedin.com/in/WES/?originalSubdomain=ca"><i class="fa-brands fa-linkedin mr-2"></i>WES</a></li>
                        <li><a class="text-white-50 small" target="_blank" href="WES"><i class="fa-brands fa-youtube mr-2"></i>WES Training & Consulting</a></li>
                    </ul>
                </div>
            </div>
            <div class="row text-center">
                <!-- Copyright -->
                <div class="footer-copyright px-2 py-2">2022, Copyright, all rights reserved</div>
                <!-- Copyright -->
            </div>
    
        
        </div>
        <!-- Footer Elements -->


    </footer>
    <!-- Footer -->

    <script type="text/javascript">

    $(document).ready(function () {
        var count = 0;
        var quiz = [];
        var check = 0;
        var selectedOption = '';
        var result = '';
        const id = '<%= sess_id %>'
        const name = '<%= sess_name %>'
        const parameters = '<%= process.env.PORT %>' ? '<%= process.env.PORT %>' : '5000';

        $("#submitQuiz").on('click', (e) => {
            e.preventDefault();
            count++;
            console.log(count);
            const courseID = $('#courseID').val();
            const correct = $('#correct').val();
            const wrongOne = $('#wrongOne').val();
            const wrongTwo = $('#wrongTwo').val();
            const wrongThree = $('#wrongThree').val();
            

            if( $('input[type=radio][name=quiz]:checked')){
                selectedOption =  $('input[type=radio][name=quiz]:checked').val();
            }

            console.log("selectedOption: ", selectedOption);


            $.ajax({
                url : `http://localhost:`+parameters+`/api/checkQuiz/`,
                method : "GET",
                // contentType: "application/json",
                data : {count: count, id: id, courseID: courseID, correct: selectedOption },
                dataType: "JSON",

                success: function (data, status, xhr) {
                    console.log("quizResult: ", data);
                    console.log("quiz: ", data[0]);
                    console.log("check: ", data[1]);
                    quiz = data[0];
                    check = data[1];
                    console.log("che: ", check.check)

                    $('input[type=radio]').prop('checked', false)

                    if(count == 1){
                        $("#question").html('<%= quiz.question[1] %>' );
                        $("#length").html('2/<%= quiz.question.length %>' );
                        $("#correctLabel").html('<%= quiz.correct[1] %>' );
                        $("#correct").val('<%= quiz.correct[1] %>' );
                        $("#wrongLabelOne").html('<%= quiz.wrong[1][0] %>' );
                        $("#wrongLabelTwo").html('<%= quiz.wrong[1][1] %>' );
                        $("#wrongLabelThree").html('<%= quiz.wrong[1][2] %>' );

                        console.log($("#correct").val());

                    }else if(count == 2){
                        $("#question").html('<%= quiz.question[2] %>' );
                        $("#length").html('3/<%= quiz.question.length %>' );
                        $("#correctLabel").html('<%= quiz.correct[2] %>' );
                        $("#correct").val('<%= quiz.correct[2] %>' );
                        $("#wrongLabelOne").html('<%= quiz.wrong[2][0] %>' );
                        $("#wrongLabelTwo").html('<%= quiz.wrong[2][1] %>' );
                        $("#wrongLabelThree").html('<%= quiz.wrong[2][2] %>' );
                    }else if(count == 3){
                        $("#question").html('<%= quiz.question[3] %>' );
                        $("#length").html('4/<%= quiz.question.length %>' );
                        $("#correctLabel").html('<%= quiz.correct[3] %>' );
                        $("#correct").val('<%= quiz.correct[3] %>' );
                        $("#wrongLabelOne").html('<%= quiz.wrong[3][0] %>' );
                        $("#wrongLabelTwo").html('<%= quiz.wrong[3][1] %>' );
                        $("#wrongLabelThree").html('<%= quiz.wrong[3][2] %>' );
                    }else if(count == 4){
                        $("#question").html('<%= quiz.question[4] %>' );
                        $("#length").html('5/<%= quiz.question.length %>' );
                        $("#correctLabel").html('<%= quiz.correct[4] %>' );
                        $("#correct").val('<%= quiz.correct[4] %>' );
                        $("#wrongLabelOne").html('<%= quiz.wrong[4][0] %>' );
                        $("#wrongLabelTwo").html('<%= quiz.wrong[4][1] %>' );
                        $("#wrongLabelThree").html('<%= quiz.wrong[4][2] %>' );
                    }else{
                        result = check.check >= 3 ? 'Passed' : 'Failed';
                        if(result == 'Passed'){
                            $.ajax({
                                url : `http://localhost:`+parameters+`/api/certificate`,
                                method : "GET",
                                // contentType: "application/json",
                                data : {id: id, name: name },
                                dataType: "JSON",

                                success: function (data, status, xhr){
                                    console.log("cert")
                                },
                                error: function (jqXhr, textStatus, errorMessage) {
                                    console.log("failed: ", errorMessage);
                                }
                            })
                            
                        }
                        $("#exampleModalLong").modal({backdrop: 'static', keyboard: false});
                        $("#result").html(check.check+ ' out of <%= quiz.question.length %>   ' +result );
                        $("#exampleModalLong").modal('show');
                    }
                },
                error: function (jqXhr, textStatus, errorMessage) {
                    console.log("failed: ", errorMessage);
                }
            })   
        })

    });
    </script>
</body>

</html>